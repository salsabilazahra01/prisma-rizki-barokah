<!DOCTYPE html>
<html lang="en" xmlns:th="http://thymeleaf.org">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Water</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap css -->
  <link rel = "stylesheet" href = "/../bootstrap/css/bootstrap.css">
  <link rel="stylesheet" href="/../style.css">
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- Bootstrap icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">

</head>

<body class="d-flex flex-column min-vh-100">
  <header>
    <nav th:replace="fragments/fragment :: navbar('Donasi')"></nav>
  </header>
  <main class="container flex-grow-1 pt-lg-5">
    <article class="card rounded-25 m-4 p-4">
      <section class="card-body justify-content-center">
        <header class="row mt-2 mb-4">
          <!-- If update = false show BUat Jenis -->
          <h2 class="col text-start h2" th:text="${title}"></h2>
        </header>
        <main class="section">
          <!-- Form using RewardDTO -->
          <form th:object="${reward}" method="POST" class="d-flex flex-column">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <row class="mb-3 row">
              <column class="col d-flex flex-column gap-3">
                <!-- Jenis -->
                <form-item>
                  <label for="jenis" class="form-label h6 w-100">
                    Jenis Reward<span class="text-danger">*</span>
                  </label>
                  <radio-group class="fs-5">
                    <!-- Radio of Uang and Barang, use the form-item HTML5 tag as if it's div -->
                    <radio-item class="form-check form-check-inline">
                      <input type="radio" class="form-check-input" name="jenis" id="uang" th:field="*{jenis}" value="Uang">
                      <label for="uang" class="form-check-label">Uang</label>
                    </radio-item>
                    <radio-item class="form-check form-check-inline">
                      <input type="radio" class="form-check-input" name="jenis" id="barang" th:field="*{jenis}" value="Barang" />
                      <label for="barang" class="form-check-label">Barang</label>
                    </radio-item>
                  </radio-group>
                </form-item>

                <!-- Nama Barang -->
                <form-item id="namaFormItem">
                  <label for="nama" class="form-label h6 w-100">
                    Nama Barang<span class="text-danger">*</span>
                  </label>
                  <input type="text" class="form-control" id="nama" required placeholder="Masukan nama barang" th:field="*{nama}">
                </form-item>

                <row class="row">
                    <!-- Kuantitas -->
                    <form-item class="col">
                      <label for="jumlah" class="form-label h6 w-100">
                        <span class="jumlah__name">Kuantitas</span><span class="text-danger">*</span>
                      </label>
                      <input type="number" min="0" class="form-control" id="jumlah" required th:field="*{jumlah}" />
                      <small><span class="jumlah__name">Kuantitas</span> harus dalam bentuk angka</small>
                    </form-item>
                    <!-- Satuan -->
                    <form-item class="col" id="satuanFormItem">
                      <label for="satuan" class="form-label h6 w-100">
                        Satuan<span class="text-danger">*</span>
                      </label>
                      <input placeholder="Masukan satuan barang" type="text" class="form-control" id="satuan" required th:field="*{satuan}">
                    </form-item>
                </row>
              </column>
              <column class="col d-flex flex-column gap-3">
                <form-item>
                  <label for="poin" class="form-label h6 w-100">
                    Poin Ekuivalen<span class="text-danger">*</span>
                  </label>
                  <input type="number" min="0" class="form-control" id="poin" required th:field="*{poin}">
                  <small>Poin harus dalam bentuk angka</small>
                </form-item>
              </column>
            </row>
            <div class="mb-3 col-6">
              <button type="submit" class="btn btn-primary col-6">Submit</button>

            </div>
          </form>
        </main>
      </section>
    </article>
  </main>

  <footer th:replace="fragments/fragment :: footer"></footer>

  <th:block th:include="fragments/scripts :: scripts"></th:block>
  <script>
    // On DOM load, set the value of the radio group to the value of the jenis field

    const poinForm = document.getElementById('poin');
    const jumlahForm = document.getElementById('jumlah');
    function onChangeUangNominal() {
      poinForm.value = jumlahForm.value/20;
    }
    // On jenis value change, hide/show the satuan form item
    const jenisRadioGroup = document.querySelector('radio-group');
    jenisRadioGroup.addEventListener('change', ()=>{

      const satuanFormItem = document.getElementById('satuanFormItem');
      const namaFormItem = document.getElementById('namaFormItem');
      const jenisSpan = document.querySelector('input[name="jenis"]:checked').value;
      const satuanForm = document.getElementById('satuan');
      const namaForm = document.getElementById('nama');
      const jumlahName = document.querySelectorAll('.jumlah__name');
      if (jenisSpan === 'Uang') {
        // Hide
        namaFormItem.hidden = satuanFormItem.hidden = true;
        jumlahName.forEach((name) => name.textContent = 'Nominal Uang');
        // Set satuan form required to false
        namaForm.required = satuanForm.required = false;
        namaForm.value = satuanForm.value = '';
        // Set poin form to readonly
        poinForm.readOnly = true;

        // On change jumlah, set poin to jumlah
        jumlahForm.addEventListener('keyup', onChangeUangNominal);

      }
      else {
        // Remove hidden class from satuanFormItem
        namaFormItem.hidden = satuanFormItem.hidden = false;
        jumlahName.forEach((name) => name.textContent = 'Kuantitas');
        // Set satuan form required to true
        namaForm.required = satuanForm.required = true;
        // Remove readonly from poin form
        poinForm.readOnly = false;

        // Remove event listener from jumlahForm
        jumlahForm.removeEventListener('keyup', onChangeUangNominal);
      }
    });
    jenisRadioGroup.dispatchEvent(new Event('change'));
  </script>
</body>

</html>